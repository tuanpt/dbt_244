
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: bid._airbyte_raw_thong_tin_goi_thau
select
    json_value(_airbyte_data, 
    '$."id"' RETURNING CHAR) as id,
    json_value(_airbyte_data, 
    '$."link"' RETURNING CHAR) as link,
    json_value(_airbyte_data, 
    '$."deleted"' RETURNING CHAR) as deleted,
    json_value(_airbyte_data, 
    '$."loai_tb"' RETURNING CHAR) as loai_tb,
    json_value(_airbyte_data, 
    '$."so_tbmt"' RETURNING CHAR) as so_tbmt,
    json_value(_airbyte_data, 
    '$."linh_vuc"' RETURNING CHAR) as linh_vuc,
    json_value(_airbyte_data, 
    '$."services"' RETURNING CHAR) as services,
    json_value(_airbyte_data, 
    '$."nguon_von"' RETURNING CHAR) as nguon_von,
    json_value(_airbyte_data, 
    '$."phan_loai"' RETURNING CHAR) as phan_loai,
    json_value(_airbyte_data, 
    '$."tien_dbdt"' RETURNING CHAR) as tien_dbdt,
    json_value(_airbyte_data, 
    '$."timestamp"' RETURNING CHAR) as `timestamp`,
    json_value(_airbyte_data, 
    '$."company_id"' RETURNING CHAR) as company_id,
    json_value(_airbyte_data, 
    '$."ten_khlcnt"' RETURNING CHAR) as ten_khlcnt,
    json_value(_airbyte_data, 
    '$."trang_thai"' RETURNING CHAR) as trang_thai,
    json_value(_airbyte_data, 
    '$."gia_du_toan"' RETURNING CHAR) as gia_du_toan,
    json_value(_airbyte_data, 
    '$."ten_du_toan"' RETURNING CHAR) as ten_du_toan,
    json_value(_airbyte_data, 
    '$."ben_moi_thau"' RETURNING CHAR) as ben_moi_thau,
    json_value(_airbyte_data, 
    '$."gia_goi_thau"' RETURNING CHAR) as gia_goi_thau,
    json_value(_airbyte_data, 
    '$."hinh_thuc_tb"' RETURNING CHAR) as hinh_thuc_tb,
    json_value(_airbyte_data, 
    '$."send_mail_id"' RETURNING CHAR) as send_mail_id,
    json_value(_airbyte_data, 
    '$."ten_goi_thau"' RETURNING CHAR) as ten_goi_thau,
    json_value(_airbyte_data, 
    '$."competitor_id"' RETURNING CHAR) as competitor_id,
    json_value(_airbyte_data, 
    '$."loai_hop_dong"' RETURNING CHAR) as loai_hop_dong,
    json_value(_airbyte_data, 
    '$."score_by_name"' RETURNING CHAR) as score_by_name,
    json_value(_airbyte_data, 
    '$."score_service"' RETURNING CHAR) as score_service,
    json_value(_airbyte_data, 
    '$."gia_trung_thau"' RETURNING CHAR) as gia_trung_thau,
    json_value(_airbyte_data, 
    '$."hinh_thuc_dbdt"' RETURNING CHAR) as hinh_thuc_dbdt,
    json_value(_airbyte_data, 
    '$."hinh_thuc_lcnt"' RETURNING CHAR) as hinh_thuc_lcnt,
    json_value(_airbyte_data, 
    '$."ngay_phe_duyet"' RETURNING CHAR) as ngay_phe_duyet,
    json_value(_airbyte_data, 
    '$."score_by_scope"' RETURNING CHAR) as score_by_scope,
    json_value(_airbyte_data, 
    '$."so_hieu_khlcnt"' RETURNING CHAR) as so_hieu_khlcnt,
    json_value(_airbyte_data, 
    '$."hieu_luc_e_hsdt"' RETURNING CHAR) as hieu_luc_e_hsdt,
    json_value(_airbyte_data, 
    '$."so_tbmt_version"' RETURNING CHAR) as so_tbmt_version,
    json_value(_airbyte_data, 
    '$."dia_diem_mo_thau"' RETURNING CHAR) as dia_diem_mo_thau,
    json_value(_airbyte_data, 
    '$."phuong_thuc_lcnt"' RETURNING CHAR) as phuong_thuc_lcnt,
    json_value(_airbyte_data, 
    '$."services_by_name"' RETURNING CHAR) as services_by_name,
    json_value(_airbyte_data, 
    '$."don_vi_trung_thau"' RETURNING CHAR) as don_vi_trung_thau,
    json_value(_airbyte_data, 
    '$."hinh_thuc_du_thau"' RETURNING CHAR) as hinh_thuc_du_thau,
    json_value(_airbyte_data, 
    '$."services_by_scope"' RETURNING CHAR) as services_by_scope,
    json_value(_airbyte_data, 
    '$."dia_diem_nhan_hsdt"' RETURNING CHAR) as dia_diem_nhan_hsdt,
    json_value(_airbyte_data, 
    '$."dia_diem_thuc_hien"' RETURNING CHAR) as dia_diem_thuc_hien,
    json_value(_airbyte_data, 
    '$."nhan_e_hsdt_tu_ngay"' RETURNING CHAR) as nhan_e_hsdt_tu_ngay,
    json_value(_airbyte_data, 
    '$."thoi_gian_thuc_hien"' RETURNING CHAR) as thoi_gian_thuc_hien,
    json_value(_airbyte_data, 
    '$."nhan_e_hsdt_den_ngay"' RETURNING CHAR) as nhan_e_hsdt_den_ngay,
    json_value(_airbyte_data, 
    '$."thoi_diem_dong_mo_thau"' RETURNING CHAR) as thoi_diem_dong_mo_thau,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    
    CURRENT_TIMESTAMP
 as _airbyte_normalized_at
from bid._airbyte_raw_thong_tin_goi_thau as table_alias
-- thong_tin_goi_thau
where 1 = 1